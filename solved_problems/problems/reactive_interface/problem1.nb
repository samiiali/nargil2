(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13968,        450]
NotebookOptionsPosition[     12643,        399]
NotebookOutlinePosition[     13015,        415]
CellTagsIndexPosition[     12972,        412]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Phi", "[", 
   RowBox[{"x_", ",", "y_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{"Sin", "[", 
    RowBox[{"x", "-", "y"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]n", "[", 
   RowBox[{"x_", ",", "y_", ",", "t_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Sin", "[", "x", "]"}], "+", 
   RowBox[{"Cos", "[", "x", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]p", "[", 
   RowBox[{"x_", ",", "y_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Cos", "[", 
   RowBox[{"x", "-", "y"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]r", "[", 
   RowBox[{"x_", ",", "y_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Sin", "[", 
   RowBox[{"x", "+", "y"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]o", "[", 
   RowBox[{"x_", ",", "y_", ",", "t_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Cos", "[", "x", "]"}], "-", 
   RowBox[{"Sin", "[", "y", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.697494360684676*^9, 3.697494399830698*^9}, {
  3.6974944461670523`*^9, 3.697494564072259*^9}, {3.7016888843961363`*^9, 
  3.7016889580590277`*^9}, {3.701698883864998*^9, 3.701698883934566*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eq1", "[", 
   RowBox[{"x_", ",", "y_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"-", 
    RowBox[{
     SubscriptBox["\[Del]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]], ".", 
     RowBox[{"(", 
      RowBox[{"25", " ", 
       RowBox[{
        SubscriptBox["\[Del]", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}]], 
        RowBox[{"Phi", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", "[", 
   RowBox[{"x_", ",", "y_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"-", 
    RowBox[{
     SubscriptBox["\[Del]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Rho]n", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], 
        RowBox[{
         SubscriptBox["\[Del]", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}]], 
         RowBox[{"Phi", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], "+", 
       RowBox[{
        SubscriptBox["\[Del]", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}]], 
        RowBox[{"\[Rho]n", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq3", "[", 
   RowBox[{"x_", ",", "y_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"-", 
    RowBox[{
     SubscriptBox["\[Del]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"\[Rho]p", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], 
        RowBox[{
         SubscriptBox["\[Del]", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}]], 
         RowBox[{"Phi", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], "+", 
       RowBox[{"2", 
        RowBox[{
         SubscriptBox["\[Del]", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}]], 
         RowBox[{"\[Rho]p", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}]}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq4", "[", 
   RowBox[{"x_", ",", "y_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"-", 
    RowBox[{
     SubscriptBox["\[Del]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], 
        RowBox[{"\[Rho]r", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], 
        RowBox[{
         SubscriptBox["\[Del]", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}]], 
         RowBox[{"Phi", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], "+", 
       RowBox[{"3", 
        RowBox[{
         SubscriptBox["\[Del]", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}]], 
         RowBox[{"\[Rho]r", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}]}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq5", "[", 
   RowBox[{"x_", ",", "y_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"-", "4"}], 
    RowBox[{
     SubscriptBox["\[Del]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]o", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], 
        RowBox[{
         SubscriptBox["\[Del]", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}]], 
         RowBox[{"Phi", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], "+", 
       RowBox[{"4", 
        RowBox[{
         SubscriptBox["\[Del]", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}]], 
         RowBox[{"\[Rho]o", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}]}], ")"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.697494651921473*^9, 3.6974946932733727`*^9}, {
   3.697494775026515*^9, 3.697494797266747*^9}, {3.697494838067061*^9, 
   3.6974949116603327`*^9}, {3.69749496479711*^9, 3.6974949980530987`*^9}, 
   3.701689185621812*^9, {3.701689877301281*^9, 3.70168994566886*^9}, {
   3.701689978974574*^9, 3.701690026567333*^9}, 3.701690292602219*^9, {
   3.7016903425944977`*^9, 3.701690359818883*^9}, {3.701690463715858*^9, 
   3.701690480460079*^9}, {3.7016905109560738`*^9, 3.7016905207563677`*^9}, {
   3.701691606400538*^9, 3.701691634897913*^9}, {3.701691708513735*^9, 
   3.701691708953246*^9}, {3.7016917856746063`*^9, 3.70169182124257*^9}, {
   3.701695811184964*^9, 3.701695825535412*^9}, {3.701695889214745*^9, 
   3.7016958905592127`*^9}, {3.7016988540015583`*^9, 3.7016988554934053`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"eq1", "[", 
   RowBox[{"x1", ",", "y1", ",", "t1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.701692034156157*^9, 3.7016920367400503`*^9}, {
  3.701692399705127*^9, 3.7016924078723783`*^9}}],

Cell["\<\
50*Power(E,Sin(x1 - y1))*
   (-Power(Cos(x1 - y1),2) + Sin(x1 - y1))\
\>", "Output",
 CellChangeTimes->{3.7016920378232737`*^9, 3.701692408797463*^9, 
  3.7016958336680593`*^9, 3.701695896932884*^9, 3.701698858640606*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"eq2", "[", 
   RowBox[{"x1", ",", "y1", ",", "t1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7016920580443993`*^9, 3.701692058148336*^9}, {
  3.701696008769795*^9, 3.7016960100400543`*^9}}],

Cell["\<\
Cos(x1) + Sin(x1) + 
   Power(E,Sin(x1 - y1))*
    (Cos(x1 - y1)*(Cos(x1) + Cos(2*x1 - y1) + 
         Cos(y1) + 
         (-1 + 2*Cos(x1 - y1))*Sin(x1)) - 
      2*(Cos(x1) + Sin(x1))*Sin(x1 - y1))\
\>", "Output",
 CellChangeTimes->{
  3.701692059940051*^9, 3.7016958362192497`*^9, {3.7016958812031527`*^9, 
   3.701695901591119*^9}, 3.701696014253158*^9, 3.7016988638667297`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"eq3", "[", 
   RowBox[{"x1", ",", "y1", ",", "t1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7016920766685553`*^9, 3.701692086280081*^9}, {
  3.701696017328864*^9, 3.701696018288118*^9}}],

Cell["\<\
2*(Cos(x1) - Sin(y1) - 
     ((Cos(x1) + 4*Cos(x1 - 2*y1) + 
          Cos(3*x1 - 2*y1) + 
          Sin(2*x1 - 3*y1) - 
          4*Sin(2*x1 - y1) - Sin(y1))*
        (Cosh(Sin(x1 - y1)) + 
          Sinh(Sin(x1 - y1))))/2.)\
\>", "Output",
 CellChangeTimes->{{3.7016920789760923`*^9, 3.701692088349979*^9}, 
   3.7016959075924873`*^9, 3.7016960198860683`*^9, 3.701698865926085*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"eq4", "[", 
   RowBox[{"x1", ",", "y1", ",", "t1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.701692091319462*^9, 3.7016920960608377`*^9}, {
  3.701696021656859*^9, 3.701696022624341*^9}}],

Cell["\<\
6*(1 + Power(E,Sin(x1 - y1))*
      (Power(Cos(x1 - y1),2) - Sin(x1 - y1)))*
   Sin(x1 + y1)\
\>", "Output",
 CellChangeTimes->{3.701692097124835*^9, 3.701695909827525*^9, 
  3.7016960235681257`*^9, 3.701696191429854*^9, 3.701698867872122*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"eq5", "[", 
   RowBox[{"x1", ",", "y1", ",", "t1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.701692098829157*^9, 3.701692103444915*^9}, {
  3.70169602560105*^9, 3.7016960265535593`*^9}}],

Cell["\<\
4*(4*Cos(x1) - 4*Sin(y1) - 
     ((Cos(x1) + 4*Cos(x1 - 2*y1) + 
          Cos(3*x1 - 2*y1) + 
          Sin(2*x1 - 3*y1) - 
          4*Sin(2*x1 - y1) - Sin(y1))*
        (Cosh(Sin(x1 - y1)) + 
          Sinh(Sin(x1 - y1))))/2.)\
\>", "Output",
 CellChangeTimes->{
  3.7016921040620823`*^9, 3.701695911410616*^9, 3.701696027318761*^9, 
   3.701696193993847*^9, {3.70169887100837*^9, 3.701698894737196*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"-", " ", 
   RowBox[{
    SubscriptBox["\[Del]", 
     RowBox[{"{", 
      RowBox[{"x1", ",", "y1"}], "}"}]], 
    RowBox[{"Phi", "[", 
     RowBox[{"x1", ",", "y1", ",", "t1"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7017061150394793`*^9, 3.7017061519039307`*^9}, 
   3.702227732157596*^9}],

Cell["\<\
List(-(Power(E,Sin(x1 - y1))*Cos(x1 - y1)),
   Power(E,Sin(x1 - y1))*Cos(x1 - y1))\
\>", "Output",
 CellChangeTimes->{{3.701706116680032*^9, 3.70170615245942*^9}, 
   3.702227732682006*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "y1"}], "}"}]], 
  RowBox[{"\[Rho]n", "[", 
   RowBox[{"x1", ",", "y1", ",", "t1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.702205385615363*^9, 3.702205427219166*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "x1", "]"}], "-", 
    RowBox[{"Sin", "[", "x1", "]"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.702205428798952*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The case with constant advection:", "Subsubsection",
 CellChangeTimes->{{3.702208768551244*^9, 3.702208789424034*^9}, {
  3.702212115077174*^9, 3.702212116269055*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq2", "[", 
   RowBox[{"x_", ",", "y_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"-", 
    RowBox[{
     SubscriptBox["\[Del]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Rho]n", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], 
        RowBox[{"{", 
         RowBox[{"1.5", ",", "2.5"}], "}"}]}], "+", 
       RowBox[{
        SubscriptBox["\[Del]", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}]], 
        RowBox[{"\[Rho]n", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.702208924674569*^9, 3.702208929322172*^9}, {
   3.702209068908328*^9, 3.7022090987485237`*^9}, {3.702212149670854*^9, 
   3.702212180366726*^9}, {3.7022124164974747`*^9, 3.7022124256739683`*^9}, 
   3.702216120179427*^9, 3.702216315533532*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq2", "[", 
  RowBox[{"x1", ",", "y1", ",", "t1"}], "]"}]], "Input",
 CellChangeTimes->{{3.7022089365439463`*^9, 3.7022089421300898`*^9}, {
  3.7022123857937727`*^9, 3.702212386632861*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "0.5`"}], " ", 
   RowBox[{"Cos", "[", "x1", "]"}]}], "+", 
  RowBox[{"2.5`", " ", 
   RowBox[{"Sin", "[", "x1", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.7022089426944647`*^9, {3.702209072747366*^9, 3.7022091001676817`*^9}, 
   3.702212387393024*^9, 3.702212428752569*^9, 3.7022161228451147`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{418, Automatic}, {Automatic, 127}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1187, 31, 153, "Input"],
Cell[1748, 53, 4884, 143, 604, "Input"],
Cell[CellGroupData[{
Cell[6657, 200, 244, 5, 40, "Input"],
Cell[6904, 207, 231, 5, 82, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7172, 217, 244, 5, 40, "Input"],
Cell[7419, 224, 391, 10, 175, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7847, 239, 242, 5, 40, "Input"],
Cell[8092, 246, 393, 10, 198, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8522, 261, 242, 5, 40, "Input"],
Cell[8767, 268, 253, 6, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9057, 279, 241, 5, 40, "Input"],
Cell[9301, 286, 417, 11, 198, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9755, 302, 351, 10, 45, "Input"],
Cell[10109, 314, 199, 5, 82, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10345, 324, 259, 7, 45, "Input"],
Cell[10607, 333, 205, 6, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10849, 344, 173, 2, 44, "Subsubsection"],
Cell[11025, 348, 997, 28, 106, "Input"],
Cell[CellGroupData[{
Cell[12047, 380, 213, 4, 40, "Input"],
Cell[12263, 386, 352, 9, 40, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

